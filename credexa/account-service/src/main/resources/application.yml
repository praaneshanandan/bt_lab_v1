server:
  port: 8087
  servlet:
    context-path: /api/accounts

spring:
  application:
    name: account-service

  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.kafka.KafkaAutoConfiguration

  datasource:
    url: jdbc:mysql://localhost:3306/account_db?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true
    username: root
    password: root
    driver-class-name: com.mysql.cj.jdbc.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQLDialect
        format_sql: true

  # Kafka Configuration
  kafka:
    bootstrap-servers: ${kafka.bootstrap-servers:localhost:9092}
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: 1
      retries: 3
    consumer:
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      group-id: account-service-group
      auto-offset-reset: earliest

# JWT Configuration (same as all other services)
jwt:
  secret: ${JWT_SECRET:mySecretKeyForCredexaApplicationMustBe256BitsLongForHS256AlgorithmToWorkProperly}
  expiration: 3600000

# Service URLs for Integration
integration:
  customer-service:
    url: http://localhost:8082/api/customer
    timeout: 5000
  product-service:
    url: http://localhost:8084/api/products
    timeout: 5000
  calculator-service:
    url: http://localhost:8085/api/calculator
    timeout: 10000

# Swagger/OpenAPI Configuration
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always

# Logging
logging:
  level:
    com.app.account: DEBUG
    org.springframework.web: INFO
    org.springframework.security: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"

# Batch Processing Configuration (enabled for testing)
batch:
  interest-accrual:
    enabled: true # Enabled for testing
    cron: "0 0 1 * * ?" # Run at 1:00 AM daily
  interest-capitalization:
    enabled: true # Enabled for testing
    cron: "0 0 2 1 1,4,7,10 ?" # Run at 2:00 AM on 1st of Jan, Apr, Jul, Oct
  maturity-processing:
    enabled: true # Enabled for testing
    cron: "0 0 3 * * ?" # 3:00 AM daily

# Kafka Configuration (TEMPORARILY DISABLED for testing)
kafka:
  enabled: false # Kafka DISABLED temporarily
  bootstrap-servers: localhost:9092 # Change this to your Kafka broker
  topics:
    account-created: account-created
    transaction: account-transaction
    alert: customer-alert
